# .github/workflows/ci_fastapi.yml (Actualizado)
name: CI/Build Docker Image para FastAPI

on:
  push:
    branches:
      - main

jobs:
  build-docker-image:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout del repositorio
      uses: actions/checkout@v4

    - name: Construir la imagen Docker
      # El comando docker build usa el Dockerfile que acabas de crear
      # La etiqueta (tag) 'fastapi-app:latest' es local para la ejecuci칩n de la acci칩n
      run: docker build . --tag fastapi-app:latest

    - name: Simular ejecuci칩n del contenedor (opcional)
      # Simula que la imagen funciona correctamente ejecut치ndola brevemente
      run: |
        docker run -d --name fastapi-container -p 8000:8000 fastapi-app:latest
        sleep 5
        curl http://localhost:8000
        docker stop fastapi-container
